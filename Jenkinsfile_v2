/* groovylint-disable-next-line CompileStatic */
pipeline{
    environment
    {
        registry = "swathiguptha/student-form-image"
        registryCredential = "docker-login"
        date = new Date().format('yy. M')
        tag = "${date}"
    }
    agent any
    stages
    {
        stage('Building docker image')
        {
            steps
            {
                script
                {
                    sh 'echo ${BUILD_TIMESTAMP}'
                    image = docker.build("swathiguptha/student-form-image"+"${tag}")
                    /*docker.withRegistry('', registryCredential) {
                       def dockerImage = docker.build("swathiguptha/student-form-image:+${BUILD_TIMESTAMP}")
                    }*/
                }
            }
        }
        stage('deploy docker image')
        {
            steps
            {
                script
                {
                    docker.withRegistry('',registryCredential)
                    {
                        image.push("${BUILD_TIMESTAMP}")
                        image.push("latest")
                    }
                }
            }
        }

    }
}